{% if id_entrada %}
<div class="row col-12 mb-4">
    <div class="col-1">
      <i id="prev" class="align-self-center fa fa-chevron-left fa-5x" aria-hidden="true" onclick="fnjs_prev()"></i>
    </div>
    <div class="col-10">
        <div class="clearfix ">
          <div class="d-inline-flex float-left">
            <div class="p-2 text-dark font-weight-bold" >
              {{ cabeceraIzqd|raw }}
            </div>
          </div>
          <div class="d-inline-flex float-right">
            <div class="p-2 text-dark font-weight-bold align-top text-right" >
              {{ cabeceraDcha|raw }}
            </div>
          </div>
        </div>
    </div>
    <div class="col-1">
      <i id="next" class="align-self-center fa fa-chevron-right fa-5x" aria-hidden="true" onclick="fnjs_next()"></i>
    </div>
</div>

<!--  --------------- ASUNTO --------------- -->
<div class="row">
    <div class="ml-3 col-11 alert alert-primary">
      <label for="asunto_e" class="col-form-label">{{ "Asunto entrada"|trans }}:</label>
        {{ asunto_e }}
    </div>
</div>

<div class="row">
    <div class="ml-3 col-11 d-flex flex-row justify-content-between">
      <div class="p-2">
        {{ "Fecha documento"|trans }}: {{ f_escrito }}
      </div>
      <div class="text-right form-group row">
        <div class="col-7 p-2 custom-control custom-switch">
          <input type="checkbox" class="custom-control-input" id="customSwitches" onChange="fnjs_read(event)" {{  chk_leido }}>
          <label class="custom-control-label" for="customSwitches">{{ "Leido el"|trans }}</label>
        </div>
        <input class="form-control col-5" name='f_entrada' id='f_entrada' type='text' value="{{ f_entrada }}" {{ f_entrada_disabled }}/>
      </div>
	</div>
	</div>
</div>
  
<!--  --------------------  ESCRITO  --------------------------  -->
<div class="row">
  <div class="ml-3 col-11 border rounded overflow-auto" id="txt" style="width: 100%; height:500px;">
  {{ escrito_html|raw }}
  </div>
</div>

<hr>
<!--  --------------------  ADJUNTOS  --------------------------  -->
<div class="form-group col-md-12">
    <label for="input-adjunto">{{ "Adjuntos"|trans }}:</label>
{% for item,nom in a_adjuntos %}
	<button type="button" class="btn btn-outline-secondary" onClick="fnjs_download({{ item }})">{{ nom }}</button>
{% endfor %}
</div>
{% else %}
<div class='p-2'></div>
<div class="container p-3 my-3 bg-danger text-white font-weight-bold">
	{{ txt_alert|raw }}
</div>
{% endif %}
{#
<div>
  <button type="button" tabindex='91' class="btn btn-secondary" onClick="fnjs_cancelar(event);" >
    {{ "Volver"|trans }}
  </button>
</div>
#}
<script>
fnjs_cancelar=function(event){
	// Asegurarme que es por click y no por return (posicion: 0,0)
	var x = event.x || event.clientX;
    var y = event.y || event.clientY;
    if (!x && !y) {
        event.preventDefault();
        event.stopPropagation();
        event.stopImmediatePropagation();
    	return false;
    }
    event.preventDefault(); //prevent default action 	
	fnjs_update_div('#main','{{ pagina_cancel|raw }}');
}

fnjs_prev=function() {
	fnjs_update_div('#main','{{ pagina_prev|raw }}');
}

fnjs_next=function() {
	fnjs_update_div('#main','{{ pagina_next|raw }}');
}

$(function() {
	$( "#f_entrada" ).datepicker( {
		numberOfMonths: 1,
		showButtonPanel: true
		});

});

fnjs_read=function(event) {
    event.preventDefault();
    event.stopPropagation();
    event.stopImmediatePropagation();

	var ok=$("#customSwitches").prop('checked')
	var f_entrada =	$("#f_entrada").val();
	if (ok) {
	  $("#f_entrada").prop('disabled', true);
	} else {
	  $("#f_entrada").prop('disabled', false);
	}
	fnjs_guardar_f_entrada(ok);
};

fnjs_guardar_f_entrada=function(ok){
	var id_entrada="{{ id_entrada }}";
	var f_entrada =	$("#f_entrada").val();

	if (ok && !f_entrada) { f_entrada='hoy'; }
	
	if (!ok) {
		//borrar
		f_entrada='';
	}
	
    var url_update = 'apps/entradas/controller/entrada_update.php';
    var param_json = { que: 'f_entrada', id_entrada: id_entrada, f_entrada: f_entrada };
    request=$.ajax({
        data: param_json,
        url: url_update,
        type: 'post'
    });
    request.done( function (rta) {
        rta_txt=rta.responseText;
        if (rta_txt==undefined) {
            rta_txt='';
        }
        if (rta_txt != '' && rta_txt != '\n') {
            alert ('error: '+rta_txt);
        }
    });
	 
}

fnjs_download=function(item) {
	url = "{{ url_download }}"+"&key="+item;
	window.open(url);
}

$(document).ready(function() {
	//tabs_hide();
});
</script>