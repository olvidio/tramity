<div id="busqueda">
  <!--  --------------- BUSQUEDAS --------------- -->
  <form id=condiciones>
	<input type="hidden" name="que" value='buscar_expediente' />
	<input type="hidden" name="id_expediente" value='{{ id_expediente }}' />
  <!--  --------------- ASUNTO --------------- -->
  <div class="form-group row">
    <label for="asunto" class="col-1 col-form-label">{{ "Asunto"|trans }}</label>
    <div class="col-10">
      <input tabindex='30' type="text" class="form-control" name="asunto" id="asunto_buscar" value="{{ asunto }}">
    </div>
  </div>
  <!--  --------------------  Periodo --------------------------  -->
  <div id="div_periodo" class="form-group row">
    <label for="periodo" class="col-1 col-form-label">{{ "periodo"|trans }}:</label>
    <div class="col-6">
		<select tabindex=111 id=periodo name=periodo >
		<option value="mes" {{ sel_mes }}>{{ "hace un mes"|trans }}</option>
		<option value="mes_6" {{ sel_mes_6 }}>{{ "hace 6 meses"|trans }}</option>
		<option value="any_1" {{ sel_any_1 }} >{{ "hace 1 año"|trans }}</option>
		<option value="any_2" {{ sel_any_2 }} >{{ "hace 2 año"|trans }}</option>
		<option value="siempre" {{ sel_siempre }} >{{ "siempre"|trans }}</option>
		</select>
	</div>
  </div>
  <!--  --------------- Etiquetas --------------- -->
  <div id="div_etiquetas" class="form-group row">
    <label for="etiquetas" class="col-1 col-form-label">{{ "Etiquetas"|trans }}:</label>
    <div class="col-9">
      <span id="span_etiquetas">
      	{{ oArrayDesplEtiquetas.ListaSelects|raw }}
      </span>
    </div>
      <!--  --------------- BOTON --------------- -->
      <div class="col-2">
        <button type="button" class="btn btn-primary" onClick="fnjs_antecedente_expediente(event);" >{{ "Buscar"|trans }}</button>
      </div>
  </div>
  </form>
</div>
<hr>
<div id="lista">
	{{ oLista.mostrar_tabla|raw }}
</div>
<script>
fnjs_antecedente_expediente=function(event) {
    var data=$('#condiciones').serialize();
    var url_ajax = 'apps/expedientes/controller/antecedentes_ajax.php';
    request=$.ajax({
        data: data,
        url: url_ajax,
        type: 'post'
    });
    request.done( function (rta) {
        //debugger;
        if (rta==undefined) {
            rta='';
        }
        $('#modal-body').html(rta);
    });
}

{{ oArrayDesplEtiquetas.ComprobarSelectJs|raw }}
fnjs_mas_etiquetas=function(e){
	var code = (e.keyCode ? e.keyCode : e.which);
	if(e=="x") {
		var valor=1;
	} else {
		var id_campo='#'+e.currentTarget.id;
		var valor=$(id_campo).val();
		if(code!=9) {
			e.preventDefault();
			e.stopPropagation();
		}
	}
	if ( code==9 || e.type=="change" || e=="x") {
		if (valor!=0) {
			{{ oArrayDesplEtiquetas.ListaSelectsJs|raw }}
		}
	}
}

fnjs_quitar_etiquetas=function(){
	$('#span_etiquetas').html("");
	$('#etiquetas_num').val(0);
}
</script>